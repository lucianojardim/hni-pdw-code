@model PDWModels.SpecRequests.TypicalMgmtInfo
@{
	ViewBag.Title = "Edit Typical";
	Layout = "~/Views/Shared/_Layout.cshtml";
}
@using ProductDataWarehouse.Models
@using ProductDataWarehouse.Controllers

<link href="@Url.Content( "~/Content/jquery.tagit.css" )" rel="stylesheet" type="text/css" />
<script src="@Url.Content( "~/Scripts/tag-it.js" )" type="text/javascript"></script>

@if( ViewBag.CloseFancyBox ?? false )
{
    <script type="text/javascript">
    	$(document).ready(function () {
    		parent.$.fancybox.close();
    		if (parent.loadSpecRequests) {
    			parent.loadSpecRequests();
    		}
    	});
    </script>
}
else
{
    <script type="text/javascript">
		var seriesList = [@Html.Raw( SpecRequestController.GetJustSeriesNameList() )];

    	$(document).ready(function () {
    		$('#SeriesList').tagit({
				availableTags: seriesList,
    			allowSpaces: true,
    			beforeTagAdded: function (event, ui) {
    				// do something special
					var isValid = false;
					$.each(seriesList, function(idx, i) {
						if (i.toLowerCase() == ui.tagLabel.toLowerCase()) {
							isValid = true;
						}
					});
					console.log( 'pre add: ' + ui.tagLabel + ' = ' + isValid );
					return isValid;
    			}
    		});

    		$('#FeaturedSeries').tagit({
				availableTags: seriesList,
    			allowSpaces: true,
				tagLimit: 1,
    			beforeTagAdded: function (event, ui) {
    				// do something special
					var isValid = false;
					$.each(seriesList, function(idx, i) {
						if (i.toLowerCase() == ui.tagLabel.toLowerCase()) {
							isValid = true;
						}
					});
					console.log( 'pre add: ' + ui.tagLabel + ' = ' + isValid );
					return isValid;
    			}
    		});

    		$('#Footprint').tagit({
    			allowSpaces: true,
    			autocomplete: ({
    				source: function (request, response) {
    					$.ajax({
    						url: '@Url.Action("GetTypeAheadTypicalOptionList", "PDW")',
    						data: { format: "json", attr: 'Footprint', query: request.term },
    						dataType: 'json',
    						type: 'GET',
    						success: function (data) {
    							response($.map(data, function (item) {
    								return {
    									label: item,
    									value: item
    								}
    							}));
    						},
    						error: function (request, status, error) {
    							alert(error);
    						}
    					}
					)
    				},
    				minLength: 0
    			})
    		});

    		$('#Material').tagit({
    			allowSpaces: true,
    			autocomplete: ({
    				source: function (request, response) {
    					$.ajax({
    						url: '@Url.Action("GetTypeAheadTypicalOptionList", "PDW")',
    						data: { format: "json", attr: 'Material', query: request.term },
    						dataType: 'json',
    						type: 'GET',
    						success: function (data) {
    							response($.map(data, function (item) {
    								return {
    									label: item,
    									value: item
    								}
    							}));
    						},
    						error: function (request, status, error) {
    							alert(error);
    						}
    					}
					)
    				},
    				minLength: 0
    			})
    		});

    		$('#Finish').tagit({
    			allowSpaces: true,
    			autocomplete: ({
    				source: function (request, response) {
    					$.ajax({
    						url: '@Url.Action("GetTypeAheadTypicalOptionList", "PDW")',
    						data: { format: "json", attr: 'Finish', query: request.term },
    						dataType: 'json',
    						type: 'GET',
    						success: function (data) {
    							response($.map(data, function (item) {
    								return {
    									label: item,
    									value: item
    								}
    							}));
    						},
    						error: function (request, status, error) {
    							alert(error);
    						}
    					}
					)
    				},
    				minLength: 0
    			})
    		});

    		$('#RenderingImage').autocomplete ({
    				source: function (request, response) {
    					$.ajax({
    						url: '@Url.Action("GetTypeaheadImageList", "PDW")',
    						data: { format: "json", query: request.term, max: 15 },
    						dataType: 'json',
    						type: 'GET',
    						success: function (data) {
    							response($.map(data, function (item) {
    								return {
    									label: item,
    									value: item
    								}
    							}));
    						},
    						error: function (request, status, error) {
    							alert(error);
    						}
    					}
					)
    				},
    				minLength: 2
    			});

    	});

    </script>    
}
    <h2>Edit Typical - @Model.Name</h2>

    @using( Html.BeginForm( "EditTypical", "SpecRequest", FormMethod.Post, new { id = "theForm", name = "TheForm", enctype = "multipart/form-data" } ) )
	{
		@Html.HiddenFor( m => m.TypicalID )
		@Html.HiddenFor( m => m.RequestID )
		@Html.HiddenFor( m => m.Name )
        <span class="dataRow">@Html.MJLabelFor( m => m.FeaturedSeries, true )@Html.TextBoxFor( m => m.FeaturedSeries, new { style = "display:none" } )
			@Html.MJLabelFor( m => m.SeriesList, true )@Html.TextBoxFor( m => m.SeriesList, new { style = "display:none" } )</span>
        <span class="dataRow">@Html.MJLabelFor( m => m.ListPrice, true )@Html.TextBoxFor( m => m.ListPrice )
			@Html.MJLabelFor( m => m.AvailableForIn2, true )@Html.CheckBoxFor( m => m.AvailableForIn2 )</span>
        <span class="dataRow">@Html.MJLabelFor( m => m.Material, true )@Html.TextBoxFor( m => m.Material, new { style = "display:none" } )
			@Html.MJLabelFor( m => m.Finish, true )@Html.TextBoxFor( m => m.Finish, new { style = "display:none" } )</span>
        <span class="dataRow">@Html.MJLabelFor( m => m.Footprint, true )@Html.TextBoxFor( m => m.Footprint, new { style = "display:none" } )</span>
		<span class="dataRow">@Html.MJLabelFor( m => m.RenderingImage, true )@Html.TextBoxFor( m => m.RenderingImage )
			@Html.MJLabelFor( m => m.Notes, true )@Html.TextAreaFor( m => m.Notes )</span>
		<div class="padr30 padl30"><hr /></div>
		<span class="dataRow">@Html.MJLabelFor( m => m.xlsFile, true )<input type="file" id="xlsFile" name="xlsFile" accept=".xls,.xlsx" /><label>@Html.DisplayFor( m => m.xlsFileName )</label></span>
		<span class="dataRow">@Html.MJLabelFor( m => m.sifFile, true )<input type="file" id="sifFile" name="sifFile" accept=".sif" /><label>@Html.DisplayFor( m => m.sifFileName )</label></span>
		<span class="dataRow">@Html.MJLabelFor( m => m.sp4File, true )<input type="file" id="sp4File" name="sp4File" accept=".sp4" /><label>@Html.DisplayFor( m => m.sp4FileName )</label></span>
		<span class="dataRow">@Html.MJLabelFor( m => m.pdfFile, true )<input type="file" id="pdfFile" name="pdfFile" accept=".pdf" /><label>@Html.DisplayFor( m => m.pdfFileName )</label></span>
		<span class="dataRow">@Html.MJLabelFor( m => m.dwgFile, true )<input type="file" id="dwgFile" name="dwgFile" accept=".dwg" /><label>@Html.DisplayFor( m => m.dwgFileName )</label></span>
@Html.ValidationSummary()
        <input type="submit" class="btn_type1" value="Update" id="submitBtn" />
	}
